import{c as h,r as d,j as e,m as p,d as B,a as V,u as Y,b as _,B as c,M as N}from"./index-c6f04137.js";import{C as P,a as T,b as A,d as F,c as L,e as G}from"./card-4b24962a.js";import{T as U}from"./textarea-2f6ef185.js";import{L as $}from"./label-74ca07f3.js";import{A as W,a as Q,b as Z,c as K,d as X,e as ee,f as te,g as se,h as ae}from"./alert-dialog-4d4a2cc4.js";import{C as re}from"./calendar-days-1d227aa6.js";const ie=h("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),le=h("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),ne=h("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),oe=h("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),ce=h("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),b=h("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),de=h("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),me=({images:r,placeName:n})=>{const[i,s]=d.useState(0);return!r||r.length===0?e.jsx("div",{children:e.jsx("p",{className:"ml-2",children:"No images available"})}):e.jsxs("div",{children:[e.jsx(p.div,{initial:{opacity:.5,x:100},animate:{opacity:1,x:0},exit:{opacity:.5,x:-100},transition:{type:"tween",duration:.5}},i),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex space-x-2",children:r.map((t,m)=>e.jsx("button",{onClick:()=>s(m),className:`w-3 h-3 rounded-full ${i===m?"bg-primary":"bg-white/50"}`,"aria-label":`Go to image ${m+1}`},m))})]})},xe=({rating:r,setRating:n})=>e.jsx("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(i=>e.jsx(b,{className:`w-8 h-8 cursor-pointer transition-colors ${i<=r?"text-yellow-400 fill-yellow-400":"text-gray-300 hover:text-yellow-300"}`,onClick:()=>n(i)},i))}),ue=async r=>{const n=localStorage.getItem("touristPlacesIndia");if(n){const s=JSON.parse(n).find(t=>t.id===r);if(s){const t=s.price===void 0||s.price===null||s.price<0?0:s.price;return{...s,price:t,longDescription:`${s.description} Located in the beautiful state of ${s.state}, this destination offers a unique blend of cultural heritage and natural beauty. Visitors can enjoy guided tours, local cuisine, and various recreational activities. The best time to visit is typically during pleasant weather seasons. Check local advisories for current visiting hours and entry fees.`,images:[`${s.imageSlug||"default-gallery"}-1`,`${s.imageSlug||"default-gallery"}-2`,`${s.imageSlug||"default-gallery"}-3`],rating:s.rating||(Math.random()*(5-3.5)+3.5).toFixed(1),reviewsCount:s.reviewsCount||Math.floor(Math.random()*200)+50,visitingHours:"9:00 AM - 5:00 PM (approx.)",entryFee:t>0?`₹${t} per person (approx.)`:"Free Entry",nearestTransport:"Well connected by road. Nearest railway station and airport vary by location.",category:s.theme||"General Interest",coordinates:s.coordinates||{lat:0,lng:0}}}}return null},we=()=>{const{id:r}=B(),n=V(),{user:i}=Y(),{toast:s}=_(),[t,m]=d.useState(null),[k,S]=d.useState(!0),[C,f]=d.useState([]),[v,R]=d.useState(""),[y,D]=d.useState(0),[I,j]=d.useState(!1),E=async()=>{S(!0);try{const a=await ue(r);a?(m(a),q(r)):(s({variant:"destructive",title:"Error",description:"Place not found."}),n("/places"))}catch(a){console.error("Failed to fetch place details:",a),s({variant:"destructive",title:"Error",description:"Could not load place details."})}finally{S(!1)}};d.useEffect(()=>{E()},[r,n,s]);const q=a=>{const l=JSON.parse(localStorage.getItem("placeReviews"))||{};f(l[a]||[])},M=(a,l)=>{const o=l.reduce((u,J)=>u+J.rating,0),x=l.length>0?(o/l.length).toFixed(1):(Math.random()*(5-3.5)+3.5).toFixed(1),g=l.length,H=(JSON.parse(localStorage.getItem("touristPlacesIndia"))||[]).map(u=>u.id===a?{...u,rating:x,reviewsCount:g}:u);localStorage.setItem("touristPlacesIndia",JSON.stringify(H)),t&&t.id===a&&m(u=>({...u,rating:x,reviewsCount:g}))},O=a=>{if(a.preventDefault(),!i){s({variant:"destructive",title:"Login Required",description:"Please log in to submit a review."}),n("/login");return}if(v.trim()===""||y===0){s({variant:"destructive",title:"Incomplete Review",description:"Please provide a rating and comment."});return}const l={id:`review_${Date.now()}_${i.id}`,placeId:r,userId:i.id,userName:i.fullName,rating:y,text:v,date:new Date().toISOString()},o=JSON.parse(localStorage.getItem("placeReviews"))||{},x=o[r]||[];o[r]=[l,...x],localStorage.setItem("placeReviews",JSON.stringify(o)),f(o[r]),M(r,o[r]),R(""),D(0),j(!1),s({title:"Review Submitted!",description:"Thank you for your feedback."})},z=a=>{if(!i){s({variant:"destructive",title:"Error",description:"You must be logged in to delete reviews."});return}const l=JSON.parse(localStorage.getItem("placeReviews"))||{};let o=l[r]||[];const x=o.find(g=>g.id===a);if(!x){s({variant:"destructive",title:"Error",description:"Review not found."});return}if(x.userId!==i.id){s({variant:"destructive",title:"Unauthorized",description:"You can only delete your own reviews."});return}l[r]=o.filter(g=>g.id!==a),localStorage.setItem("placeReviews",JSON.stringify(l)),f(l[r]),M(r,l[r]),s({title:"Review Deleted",description:"Your review has been removed."})};if(k)return e.jsx("div",{className:"flex justify-center items-center h-[calc(100vh-10rem)]",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-t-4 border-b-4 border-primary"})});if(!t)return e.jsxs("div",{className:"text-center py-10",children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Place not found"}),e.jsx(c,{onClick:()=>n("/places"),className:"mt-4",children:"Back to Places"})]});const w=()=>{if(t.coordinates&&t.coordinates.lat&&t.coordinates.lng){const a=`${t.maplink}`;window.open(a,"_blank")}else s({variant:"destructive",title:"Location Error",description:"Coordinates not available for this place."})};return e.jsxs(p.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"space-y-8 p-4 md:p-8",children:[e.jsxs(c,{variant:"outline",onClick:()=>n(-1),className:"mb-6",children:[e.jsx(ie,{className:"mr-2 h-4 w-4"})," Back to List"]}),e.jsx(me,{images:t.images,placeName:t.name}),e.jsxs(P,{className:"shadow-xl glassmorphic",children:[e.jsx(T,{children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-start",children:[e.jsxs("div",{children:[e.jsx(A,{className:"text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent mb-1",children:t.name}),e.jsxs("div",{className:"flex items-center text-muted-foreground text-sm",children:[e.jsx(N,{className:"w-4 h-4 mr-1 text-primary"}),e.jsxs("span",{children:[t.location,", ",t.state]})]}),e.jsx("span",{className:"mt-2 inline-block px-3 py-1 text-xs font-semibold text-accent-foreground bg-accent/80 rounded-full",children:t.category})]}),e.jsxs("div",{className:"flex flex-col items-end mt-4 md:mt-0 space-y-2",children:[e.jsxs("div",{className:"flex items-center text-lg",children:[e.jsx(b,{className:"w-6 h-6 text-yellow-400 mr-1"}),t.rating=e.jsx("span",{className:"font-semibold",children:t.rating}),e.jsxs("span",{className:"text-sm text-muted-foreground ml-1",children:["(",t.reviewsCount," reviews)"]})]}),e.jsx("div",{className:"text-3xl font-bold text-primary flex items-center",children:t.price>0?e.jsxs(e.Fragment,{children:[" ₹",t.price," "]}):e.jsx("span",{className:"text-2xl",children:"Free Entry"})})]})]})}),e.jsxs(F,{className:"space-y-6",children:[e.jsx(L,{className:"text-lg text-foreground/90 leading-relaxed",children:t.longDescription}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-xl font-semibold text-foreground flex items-center",children:[e.jsx(ne,{className:"w-5 h-5 mr-2 text-primary"})," Quick Info"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{className:"text-foreground",children:"Visiting Hours:"})," ",t.visitingHours]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{className:"text-foreground",children:"Entry Fee:"})," ",t.entryFee]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx("strong",{className:"text-foreground",children:"Nearest Transport:"})," ",t.nearestTransport]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h3",{className:"text-xl font-semibold text-foreground",children:"Location"}),e.jsxs(c,{variant:"outline",size:"sm",onClick:w,disabled:!t.coordinates||!t.coordinates.lat,children:["View on Google Maps ",e.jsx(le,{className:"ml-2 h-4 w-4"})]})]}),e.jsx("div",{className:"aspect-video bg-muted rounded-lg overflow-hidden",children:t.coordinates&&t.coordinates.lat?e.jsxs("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:[e.jsx(N,{className:"w-12 h-12 text-primary"}),e.jsxs("p",{onClick:w,children:[e.jsx("img",{onClick:w,src:"/image.jpg",alt:"Description",style:{width:"50000px",marginLeft:"1px"}}),"Interactive Map Placeholder"]})]}):e.jsxs("div",{className:"w-full h-full flex items-center justify-center text-muted-foreground",children:[e.jsx(N,{className:"w-12 h-12 text-gray-400"}),e.jsx("p",{className:"ml-2 text-lg",children:"Map data not available"})]})}),t.coordinates&&t.coordinates.lat&&e.jsx("p",{className:"text-xs text-muted-foreground mt-2"})]})]})]}),e.jsx(G,{className:"flex flex-col sm:flex-row justify-end items-center gap-4 pt-6 border-t border-border",children:e.jsxs(c,{size:"lg",className:"w-full sm:w-auto bg-gradient-to-r from-primary to-accent hover:opacity-90 transition-opacity text-lg py-7 px-10 rounded-full shadow-lg transform hover:scale-105",onClick:()=>n(`/booking/${t.id}`),children:[e.jsx(re,{className:"mr-2 h-6 w-6"})," ",k?"Booking...":"Book Now"]})})]}),e.jsxs(P,{className:"shadow-xl glassmorphic",children:[e.jsxs(T,{children:[e.jsxs(A,{className:"text-3xl font-bold text-primary flex items-center",children:[e.jsx(oe,{className:"w-7 h-7 mr-3"}),"Reviews & Ratings"]}),e.jsxs(L,{children:["See what other travelers are saying about ",t.name,"."]})]}),e.jsxs(F,{className:"space-y-6",children:[!I&&i&&e.jsxs(c,{onClick:()=>j(!0),variant:"outline",className:"mb-4",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"})," Write a Review"]}),!i&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.jsx(c,{variant:"link",className:"p-0 h-auto",onClick:()=>n("/login"),children:"Log in"})," to write a review."]}),I&&i&&e.jsxs(p.form,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.3},onSubmit:O,className:"space-y-4 p-4 border rounded-lg bg-background/50",children:[e.jsxs("div",{children:[e.jsx($,{htmlFor:"rating",className:"text-lg font-medium",children:"Your Rating"}),e.jsx(xe,{rating:y,setRating:D})]}),e.jsxs("div",{children:[e.jsx($,{htmlFor:"reviewText",className:"text-lg font-medium",children:"Your Review"}),e.jsx(U,{id:"reviewText",value:v,onChange:a=>R(a.target.value),placeholder:`Share your experience at ${t.name}...`,rows:4,required:!0})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(c,{type:"submit",children:"Submit Review"}),e.jsx(c,{type:"button",variant:"ghost",onClick:()=>j(!1),children:"Cancel"})]})]}),C.length>0?e.jsx("div",{className:"space-y-6",children:C.map(a=>e.jsxs(p.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"p-4 border rounded-lg bg-card/80 shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("div",{className:"flex-col",children:[e.jsx("h4",{className:"font-semibold text-primary",children:a.userName}),e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((l,o)=>e.jsx(b,{className:`w-4 h-4 ${o<a.rating?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},o))})]}),i&&i.id===a.userId&&e.jsxs(W,{children:[e.jsx(Q,{asChild:!0,children:e.jsx(c,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive hover:bg-destructive/10",children:e.jsx(de,{className:"w-5 h-5"})})}),e.jsxs(Z,{children:[e.jsxs(K,{children:[e.jsx(X,{children:"Are you sure?"}),e.jsx(ee,{children:"This action cannot be undone. This will permanently delete your review."})]}),e.jsxs(te,{children:[e.jsx(se,{children:"Cancel"}),e.jsx(ae,{onClick:()=>z(a.id),className:"bg-destructive hover:bg-destructive/90",children:"Delete"})]})]})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:new Date(a.date).toLocaleDateString()}),e.jsx("p",{className:"text-sm text-foreground/90",children:a.text})]},a.id))}):e.jsxs("p",{className:"text-muted-foreground",children:["No reviews yet for ",t.name,". Be the first to share your experience!"]})]})]})]})};export{we as default};
